<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<CSP name="bootstrap/js/mdg_lib.js" application="/csp/vacancy/"><![CDATA[
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="bootstrap/js/jquery.js"></script>
    <!-- ОООЧЕНЬ медленно
    <script src="http://code.jquery/jquery-latest.js"></script>	-->
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>

    <script src="bootstrap/js/angular-cookies.min.js"></script>
    <script src="bootstrap/js/angular-loader.min.js"></script>
    <script src="bootstrap/js/angular-bootstrap-prettify.min.js"></script>
    <script src="bootstrap/js/angular-bootstrap.min.js"></script>
    <script src="bootstrap/js/angular-cookies.min.js"></script>
    <script src="bootstrap/js/angular-loader.min.js"></script>
    <script src="bootstrap/js/angular-resource.min.js"></script>
    <script src="bootstrap/js/angular-sanitize.min.js"></script>
<!-- Обработчик страницы -->
<script language ="javascript"> 
function control ($scope,$http){
		$scope.getVacancies=function(){
		$http.get("/v/json/vacanciesold").success(function(data){
			$scope.vacancies=data.children;}).error(function(data,status){
			$scope.alertzone="["+status+"] Error upload vacancy list :( ["+data+"]"; });
		    }
	 $scope.getCompanies=function(){
		$http.get("/v/json/companies").success(function(data){
			$scope.companies=data.children;}).error(function(data,status){
			$scope.alertzone="["+status+"] Error upload company list :( ["+data+"]"; });
		    }
		$scope.getCompany=function(compid){
		$http.get("/v/json/company/"+compid).success(function(data){
			$scope.company=data.children;}).error(function(data,status){
			$scope.alertzone="["+status+"] Error upload one company :( ["+data+"]"; });
		    }
		 
		 $scope.getVacancy=function(compid){
		$http.get("/v/json/vacancy/"+compid).success(function(data){
			$scope.vacancy=data.children;}).error(function(data,status){
			$scope.alertzone="["+status+"] Error upload one vacancy :( ["+data+"]"; });
		    }   
		    
		    // добавляем обновление ВЫЗЫВАЕМ ЕЁ ТУТ
		 $scope.update = function (compid){ 
		      var url = "/v/json/v/"+compid[0].ID;
		 $http.put(url ,compid[0])
		     .success(function(data){$scope.alertzone="Update Ok!"+compid[0].Name;}).error(function(data,status){
			 $scope.alertzone="["+status+"]Error update vacancy data:( ["+data+"]"; });
			 //$scope.alert2="/v/json/vacancy/"+vacancy[0].ID;
		     }
		 // удаление вакансии
	    $scope.deletevacancy = function (v){
		    $http.delete("/v/json/vacancy/"+v[0].ID)
		    .success(function(data){
			    document.location.href = "/csp/vacancy/index.csp";
			    }).error(function(data,status){
			$scope.alertzone="["+status+"] Error delete vacancy :( ["+data+"]"; });
		    }    
$scope.createvacancy = function (v){
		    // что б кашэ был в курсе что мы ему предлагаем
		    // company. class="Data.Company";
		    $http.post("/v/json/vacancy",v)
		    .success(function(data){document.location.href = "/csp/vacancy/index.csp";}).error(function(data,status){
			$scope.alertzone="["+status+"] Error creating new vacancy :( ["+data+"]"; });
		    }		    

]]></CSP>
</Export>
